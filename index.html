<!DOCTYPE html>
<html lang="ja">
<style>
    .error {
        color: red;
    }
</style>

<head>
    <meta charset="UTF-8">
    <title>大阪電通生向けかゆいところに手が届くサイト</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/push.js/0.0.11/push.min.js"></script>
    <script src="Main.js"></script>
    <script src="BUS_Time_KIntetsu.js"></script>
    <script src="BUS_Time_OECU.js"></script>
    <!-- <script src="json_load.js"></script> -->
</head>

<body>
    <h1>大阪電通生向けかゆいところに手が届くサイト</h1>
    <span>Made by 凛音(<a href="https://x.com/hs_oecu">Twitter</a>)</span><br>
    <div style="display: none;">
        <span>キャンパス:</span>
        <select name="campus" id="Campus" disabled>
            <option value="Neyagawa">寝屋川キャンパス</option>
            <option value="Shijonawate" selected>四條畷キャンパス</option>
        </select>
    </div>
    <h2>
        <div id="clock">現在時刻:時刻を取得できません。</div><br>
        <div id="textA">次の授業まで:</div>
    </h2>
    <!-- <button disabled>リンクで保存(準備中)</button> -->
    <div id="Kouji_Sijounawate">
        <span>校時表(四條畷キャンパス)</span>
        <table border="3">
            <tr>
                <th>次限</th>
                <th><input id="Shijonawate_1" type="checkbox" checked>1限</th>
                <th><input id="Shijonawate_2" type="checkbox" checked>2限</th>
                <th><input id="Shijonawate_3" type="checkbox" checked>3限</th>
                <th><input id="Shijonawate_4" type="checkbox" checked>4限</th>
                <th><input id="Shijonawate_5" type="checkbox" checked>5限</th>
            </tr>
            <tr>
                <th>始まり</th>
                <th>9:30</th>
                <th>11:25</th>
                <th>13:55</th>
                <th>15:50</th>
                <th>17:45</th>
            </tr>
            <tr>
                <th>終わり</th>
                <th>11:15</th>
                <th>13:10</th>
                <th>15:40</th>
                <th>17:35</th>
                <th>19:30</th>
            </tr>
        </table>
        <br>
        <span><a href="index.html?Campus=Neyagawa">寝屋川キャンパス→</a></span>
        <h1>バス出発時刻(四條畷電通大/四條畷キャンパス)</h1>
        <select id="Bus_Time_Shijonawate">
            <option value="Now" selected>現在時刻</option>
            <option value="E1">1限終了時</option>
            <option value="E2">2限終了時</option>
            <option value="E3">3限終了時</option>
            <option value="E4">4限終了時</option>
            <option value="E5">5限終了時</option>
        </select>行き先(近鉄バス):
        <select id="Filter_Kintetsu">
            <option value="All" selected>全て(61],[62],[直行])</option>
            <option value="Shijonawate0">四條畷(清滝団地経由のみ[61])</option>
            <option value="Shijonawate1">四條畷(直行以外[61],[62])</option>
            <option value="Shijonawate2">四條畷(直行のみ[直行])</option>
        </select>ダイヤ:
        <select id="schedule_Shijonawate" disabled>
            <option value="Auto" selected>自動</option>
            <option value="normal">平日ダイヤ</option>
            <option value="holiday">土日祝ダイヤ</option>
            <option value="vacation" disabled>学休期間ダイヤ</option>
        </select>
        <table border="3">
            <tr>
                <th>
                </th>
                <th colspan="3">
                    dep. 1st
                </th>
                <th colspan="3">
                    dep. 2nd
                </th>
            </tr>
            <tr>
                <th>
                    会社
                </th>
                <th>
                    出発時刻
                </th>
                <th>
                    行き先
                </th>
                <th>
                    出発までの時間
                </th>
                <th>
                    出発時刻
                </th>
                <th>
                    行き先
                </th>
                <th>
                    出発までの時間
                </th>
            </tr>
            <tr>
                <th>
                    近鉄バス(四条畷駅方面)
                </th>
                <th>
                    <span id="time_Kintetsu"></span>
                </th>
                <th><span id="To_Kintetsu"></span>
                </th>
                <th><span id="UntilNextBus_Kintetsu">
                        <font color="#ff0000">非対応</font>
                    </span>
                </th>
                <th>
                    <span id="time_Kintetsu_2nd"></span>
                </th>
                <th><span id="To_Kintetsu_2nd"></span>
                </th>
                <th><span id="UntilNextBus_Kintetsu_2nd">
                        <font color="#ff0000">非対応</font>
                    </span>
                </th>
            </tr>
            <tr>
                <th>
                    電通大スクールバス
                </th>
                <th>
                    <span id="time_OECU_Shijonawate"></span>
                </th>
                <th>
                    <span id="To_OECU_Shijonawate"></span>
                </th>
                <th><span id="UntilNextBus_OECU_Shijonawate">
                        <font color="#ff0000">非対応</font>
                    </span>
                </th>
                <th>
                    <span id="time_OECU_Shijonawate_2nd"></span>
                </th>
                <th>
                    <span id="To_OECU_Shijonawate_2nd"></span>
                </th>
                <th><span id="UntilNextBus_OECU_Shijonawate_2nd">
                        <font color="#ff0000">非対応</font>
                    </span>
                </th>
            </tr>
        </table>
<!-- <h1>バス出発時刻(四条畷)</h1>
        <table border="3">
            <tr>
                <th>
                </th>
                <th colspan="4">
                    dep. 1st
                </th>
                <th colspan="4">
                    dep. 2nd
                </th>
            </tr>
            <tr>
                <th>
                    会社
                </th>
                <th>
                    時刻
                </th>
                <th>
                    行き先
                </th>
                <th>
                    出発までの時間
                </th><th>
                    到着予定時刻(所要時間)
                </th>
                <th>
                    時刻
                </th>
                <th>
                    行き先
                </th>
                <th>
                    出発までの時間
                </th><th>
                    到着予定時刻(所要時間)
                </th>
            </tr>
            <tr>
                <th>
                    近鉄バス(四條畷電通大方面)
                </th>
                <th colspan="4">
                     <span>準備中です。今後のアップデートにご期待ください。</span>
                </th>
                <th colspan="4">
                     <span>準備中です。今後のアップデートにご期待ください。</span>
                </th>
            </tr>
        </table> -->
        <font color="#ff0000">
            電通大スクールバスは2025年4月17日時点のダイヤ、近鉄バスは2025年10月2日時点のダイヤです。<br>四條畷キャンパス行きのバスは寝屋川キャンパスに記載しています。<br>臨時ダイヤには対応していません。<br>本サイトでは、<a
                href="https://national-holidays.jp/about.html"
                target="_blank">国民の祝日API</a>を利用し、近鉄バスの平日ダイヤと土日祝ダイヤを自動で分ける処理を実装しています。
        </font>
        <!-- <br>臨時ダイヤ、学休期間ダイヤ(休校期間ダイヤ)には対応していません。 -->
        <!-- <span>From:</span>
        <select name="Start_Sijonawate" id="Start_Sijonawate">
            <option value="2">1,2,3号館</option>
            <option value="4" disabled>4号館(非対応)</option>
            <option value="5" disabled>5号館(非対応)</option>
            <option value="6">6,7号館(コナミホール前)</option>
            <option value="8" disabled>8号館(非対応)</option>
            <option value="9">9号館(KOZUKI HALL前)</option>
            <option value="10">10号館</option>
            <option value="11" disabled>11号館(非対応)</option>
            <option value="12" disabled>12号館(非対応)</option>
        </select><br><span>To:</span>
        <select name="Arrival_Sijonawate" id="Arrival_Sijonawate">
            <option value="2">1,2,3号館</option>
            <option value="4" disabled>4号館(非対応)</option>
            <option value="5" disabled>5号館(非対応)</option>
            <option value="6">6,7号館(コナミホール前)</option>
            <option value="8" disabled>8号館(非対応)</option>
            <option value="9">9号館(KOZUKI HALL前)</option>
            <option value="10">10号館</option>
            <option value="11" disabled>11号館(非対応)</option>
            <option value="12" disabled>12号館(非対応)</option>
        </select>
        <div id="output_Sijonawate"></div> -->
    </div>
    <div id="Kouji_Neyagawa" style="display: none;">
        <span>校時表(寝屋川キャンパス)</span>
        <table border="3">
            <tr>
                <th>次限</th>
                <th><input id="Neyagawa_1" type="checkbox" checked>1限</th>
                <th><input id="Neyagawa_2" type="checkbox" checked>2限</th>
                <th><input id="Neyagawa_3" type="checkbox" checked>3限</th>
                <th><input id="Neyagawa_4" type="checkbox" checked>4限</th>
                <th><input id="Neyagawa_5" type="checkbox" checked>5限</th>
            </tr>
            <tr>
                <th>始まり</th>
                <th>9:00</th>
                <th>10:55</th>
                <th>13:25</th>
                <th>15:20</th>
                <th>17:15</th>
            </tr>
            <tr>
                <th>終わり</th>
                <th>10:45</th>
                <th>12:40</th>
                <th>15:10</th>
                <th>17:05</th>
                <th>19:00</th>
            </tr>
        </table>
        <br>
        <span><a href="index.html?Campus=Shijonawate">四條畷キャンパス→</a></span>
        <h1>バス出発時刻(寝屋川キャンパス)</h1>
        <select id="Bus_Time_Neyagawa">
            <option value="Now" selected>現在時刻</option>
            <option value="E1">1限終了時</option>
            <option value="E2">2限終了時</option>
            <option value="E3">3限終了時</option>
            <option value="E4">4限終了時</option>
            <option value="E5">5限終了時</option>
        </select>ダイヤ:
        <select id="schedule_Neyagawa" disabled>
            <option value="Auto" selected>自動</option>
            <option value="normal">平日ダイヤ</option>
            <option value="holiday">土日祝ダイヤ</option>
            <option value="vacation" disabled>学休期間ダイヤ</option>
        </select>
        <table border="3">
            <tr>
                <th>
                </th>
                <th colspan="3">
                    dep. 1st
                </th>
                <th colspan="3">
                    dep. 2nd
                </th>
            </tr>
            <tr>
                <th>
                    会社
                </th>
                <th>
                    時刻
                </th>
                <th>
                    行き先
                </th>
                <th>
                    出発までの時間
                </th>
                <th>
                    時刻
                </th>
                <th>
                    行き先
                </th>
                <th>
                    出発までの時間
                </th>
            </tr>
            <tr>
                <th>
                    電通大スクールバス
                </th>
                <th>
                    <span id="time_OECU_Neyagawa"></span>
                </th>
                <th><span id="To_OECU_Neyagawa"></span>
                </th>
                <th><span id="UntilNextBus_OECU_Neyagawa">
                        <font color="#ff0000">非対応</font>
                    </span>
                </th>
                <th>
                    <span id="time_OECU_Neyagawa_2nd"></span>
                </th>
                <th><span id="To_OECU_Neyagawa_2nd"></span>
                </th>
                <th>
                    <span id="UntilNextBus_OECU_Neyagawa_2nd">
                        <font color="#ff0000">非対応</font>
                    </span>
                </th>
            </tr>
        </table>
        <font color="#ff0000">
        2025年4月17日時点のダイヤです。<br>寝屋川キャンパス行きのバスと四条畷駅方面行きのバス(近鉄バス)は四條畷キャンパスに記載しています。<br>臨時ダイヤには対応していません。
        </font>
        <!-- <span>From:</span>
        <select name="Start_Neyagawa" id="Start_Neyagawa" disabled>
            <option value="A" disabled selected>A号館(非対応)</option>
        </select><br><span>To:</span>
        <select name="Arrival_Neyagawa" id="Arrival_Neyagawa" disabled>
            <option value="A" disabled selected>A号館(非対応)</option>
        </select>
        <div id="output_Neyagawa" class="error">この機能は、寝屋川キャンパスは非対応です。</div> -->
    </div>
    <span>※40fps以上が出ない端末であれば、25ミリ秒以上の遅延が発生します。</span>
    <p>Ver.2.0</p>
    <div>
        <h2>更新ログ</h2>
        <div style="width: 100%; height: 200px; overflow-y: scroll; border: 1px #999999 solid;">
            <div>Ver.1.9:祝日ダイヤ(API使用)と学休期間ダイヤに自動で対応(一部未確認),近鉄バスのダイヤを10月2日以降のダイヤに変更</div>
            <div>Ver.1.8:出発までの時刻を追加</div>
            <div>Ver.1.7:バスの出発時刻を追加,遅延を最大25ミリ秒に変更</div>
            <div>Ver.1.6:カスタム機能を追加</div>
            <div>Ver.1.5:サイト名を改名 製作者の名前を明記 所要時間の表示を廃止</div>
            <div>Ver.1.4:所要時間の表示を実装(寝屋川キャンパスは非対応)</div>
            <div>Ver.1.3:時間のズレを修正</div>
            <div>Ver.1.2:寝屋川キャンパスに完全対応</div>
            <div>Ver.1.1:5限枠の制作、寝屋川キャンパスの校時表も制作(現在の表示は非対応)</div>
            <div>Ver.1.0:完成</div>
        </div>
    </div>
    <br>
    <font color="#ff0000">
        【勤勉な学生に向けた注意事項】このサイトを授業中に見ると怠惰になります。見過ぎにはご注意ください。
    </font>
    <div>
        不具合やご要望がありましたら、製作者までご連絡ください。
    </div>
    <script>
        //
        window.onload = function () {
            /*
            if (localStorage.getItem("API_agree") != false) {
                let agree = confirm("本サイトでは、国民の祝日APIを利用し、近鉄バスの平日ダイヤと土日祝ダイヤを自動で分ける処理を実装しています。\nこのAPIでは、アクセスログ情報が保管されます。\nこのAPIの使用に同意しますか?");
                localStorage.setItem("API_agree", agree);
            }*/
            //本サイトでは、国民の祝日APIを利用し、近鉄バスの平日ダイヤと土日祝ダイヤを自動で分ける処理を実装しています。このAPIの使用に同意しますか?
            let Campus = document.getElementById('Campus');
            const params = new URLSearchParams(location.search);
            switch (params.get("Campus")) {
                case "Neyagawa":
                    Campus.selectedIndex = 0;
                    break;
                case "Shijonawate":
                    Campus.selectedIndex = 1;
                    break;
                default:
                    Campus.selectedIndex = 1;
                    break;
            }
            /*
            if (Campus.selectedIndex != null) {
                Campus.selectedIndex = sessionStorage.getItem('Campus');
            }
                */
            /*

         let schedule_Kintetsu = document.getElementById('schedule_Kintetsu').selectedIndex;
         if (isWeekend())
             schedule_Kintetsu = 1;
         else
             schedule_Kintetsu = 0;*/
            FixedonUpdate();
            setInterval(FixedonUpdate, 25);
            setInterval(Save, 1);
            // OnStartA();
        };
        function Save() {
            sessionStorage.setItem('Campus', Campus.selectedIndex);
        }
        function FixedonUpdate() {
            updateClock();
            let Campus = document.getElementById('Campus');
            let Kouji_Sijounawate = document.getElementById('Kouji_Sijounawate');
            let Kouji_Neyagawa = document.getElementById('Kouji_Neyagawa');
            switch (Campus.value) {
                case "Sijounawate":
                    Kouji_Sijounawate.style.display = 'block';
                    Kouji_Neyagawa.style.display = 'none';
                    break;
                case "Neyagawa":
                    Kouji_Neyagawa.style.display = 'block';
                    Kouji_Sijounawate.style.display = 'none';
                    break;
            }

        }
        function updateClock() {
            var now = new Date();
            var hours = now.getHours();
            var minutes = now.getMinutes();
            var seconds = now.getSeconds();
            let Campus = document.getElementById('Campus').value;
            if (Campus == "Neyagawa") {
                let schedule_Kintetsu = document.getElementById('schedule_Neyagawa').selectedIndex;
                let Bus_Time_Neyagawa = document.getElementById('Bus_Time_Neyagawa').selectedIndex;
                updateBusTimes_OECU(Campus, Bus_Time_Neyagawa);
                // document.getElementById('textA').innerText = "修正中"; return;
                if (seconds != 0) {
                    updateClassStatus(hours, minutes, (60 - seconds), "Neyagawa");
                }
                else {
                    updateClassStatus(hours, (minutes - 1), (0), "Neyagawa");
                }
            }
            else {
                //schedule_Kintetsu
                let schedule_Kintetsu = document.getElementById('schedule_Shijonawate').selectedIndex;
                let Bus_Time_Shijonawate = document.getElementById('Bus_Time_Shijonawate').selectedIndex;
                let Bus_Filter_Shijonawate = document.getElementById('Filter_Kintetsu').selectedIndex;
                updateBusTimes(Bus_Time_Shijonawate, Bus_Filter_Shijonawate, schedule_Kintetsu);
                updateBusTimes_OECU(Campus, Bus_Time_Shijonawate);
                if (seconds != 0) {
                    updateClassStatus(hours, minutes, (60 - seconds), "Shijonawate");
                }
                else {
                    updateClassStatus(hours, (minutes - 1), (0), "Shijonawate");
                }
            }

            // ゼロパディングを行う
            hours = hours < 10 ? '0' + hours : hours;
            minutes = minutes < 10 ? '0' + minutes : minutes;
            seconds = seconds < 10 ? '0' + seconds : seconds;

            // 時刻を表示する
            var timeString = hours + ':' + minutes + ':' + seconds;
            document.getElementById('clock').innerText = "現在時刻:" + timeString;
        }
    </script>

</body>

</html>